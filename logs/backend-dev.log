
> server-backup-web@1.0.0 dev:server
> PORT=${PORT:-3010} nodemon --watch src/server --exec tsx src/server/index.ts

[33m[nodemon] 3.1.11[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): src/server/**/*[39m
[33m[nodemon] watching extensions: ts,json[39m
[32m[nodemon] starting `tsx src/server/index.ts`[39m
Database connection established
Server running at http://localhost:3010
[Cron] Loading cron jobs from database...
[Cron] Stopped all jobs
[Cron] Scheduled job 1 (daily backup 2 AM) with expression: 27 12 * * * (timezone: Asia/Karachi)
[Cron] Scheduled job 5 (Daily 11) with expression: 59 23 * * * (timezone: Asia/Karachi)
[Cron] Scheduled job 6 (local backups - Scheduled Backup) with expression: 37 12 * * * (timezone: Asia/Karachi)
[Cron] Scheduled job 7 (local backups - Scheduled Backup) with expression: 0 2 * * * (timezone: Asia/Karachi)
[Cron] Loaded 4 cron job(s)
[Cron] Stopped job 6
[Cron] Stopped job 7
[Cron] Scheduled job 8 (local backups - Scheduled Backup) with expression: 0 2 * * * (timezone: Asia/Karachi)
[Cron] Scheduled job 9 (xTerminal - Scheduled Backup) with expression: 0 2 * * * (timezone: Asia/Karachi)
[Cron] Stopped job 9
[Cron] Stopped job 8
[Cron] Scheduled job 8 (local backups - Scheduled Backup) with expression: 47 12 * * * (timezone: Asia/Karachi)
[Cron] Executing backup job 8 for server 3
[Backup 86] Using server-specific local backup path: /opt/backup
[Cron] Backup job 8 completed successfully
[Backup 86] Starting backup process...
[Backup 86] Creating remote directory: /tmp/backup_2025-12-11_local_backups
[Backup 86] Skipping /var/www backup
[Backup 86] Skipping /var/log backup
[Backup 86] Skipping /etc/nginx backup
[Backup 86] Compressing /var/www/html/backup/bk...
[Backup 86] STDERR: tar: Removing leading `/' from member names

[Backup 86] Dumping all databases...
[Backup 86] STDERR: mysqldump: [Warning] Using a password on the command line interface can be insecure.

[Backup 86] STDERR: mysqldump: Error: 'Access denied; you need (at least one of) the PROCESS privilege(s) for this operation' when trying to dump tablespaces

[Backup 86] Rsyncing to local: /opt/backup/backup_2025-12-11_local_backups
[Backup 86] Local Error: Command failed: rsync -az --partial -e "sshpass -p '@dminkaka' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -p 22" root@10.240.150.158:/tmp/backup_2025-12-11_local_backups/ /opt/backup/backup_2025-12-11_local_backups/
rsync: [Receiver] Failed to exec sshpass: No such file or directory (2)
rsync error: error in IPC code (code 14) at pipe.c(85) [Receiver=3.2.7]
rsync: connection unexpectedly closed (0 bytes received so far) [Receiver]
rsync error: error in IPC code (code 14) at io.c(232) [Receiver=3.2.7]

[Backup 86] Rsync failed, falling back to SFTP
[Backup 86] Starting SFTP transfer from /tmp/backup_2025-12-11_local_backups to /opt/backup/backup_2025-12-11_local_backups
[Backup 86] SFTP Connection ready
[Backup 86] Found 2 files to transfer via SFTP
[Backup 86] SFTP downloading: local_backups_custom__var_www_html_backup_bk.tar.gz
[Backup 86] SFTP downloading: local_backups_db-dump-all.sql
[Backup 86] SFTP transfer completed successfully
[Backup 86] Cleaning up remote files...
[Backup 86] Backup completed successfully.
[Backup 86] Starting Google Drive auto-upload for backup directory...
Initializing Drive service with refresh token length: 103
[Backup 86] Drive target folder: root
Drive authentication error: invalid_grant undefined
[Backup 86] Google Drive auto-upload failed: Invalid refresh token. Please regenerate it using the OAuth flow.
Saving settings: {
  hasGlobalPath: false,
  hasDriveClientId: true,
  hasDriveClientSecret: true,
  hasDriveRefreshToken: true,
  refreshTokenLength: 103,
  hasDriveFolderId: false,
  driveAutoUpload: true
}
Settings updated successfully
